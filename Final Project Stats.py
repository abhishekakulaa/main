{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "d191e0b0",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np \n",
    "import pandas as pd \n",
    "import matplotlib.pyplot as plt \n",
    "import seaborn as sn "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "63fa1a6a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>bond_id</th>\n",
       "      <th>trade_price</th>\n",
       "      <th>current_coupon</th>\n",
       "      <th>time_to_maturity</th>\n",
       "      <th>is_callable</th>\n",
       "      <th>reporting_delay</th>\n",
       "      <th>trade_size</th>\n",
       "      <th>trade_type</th>\n",
       "      <th>curve_based_price</th>\n",
       "      <th>...</th>\n",
       "      <th>received_time_diff_last2</th>\n",
       "      <th>trade_price_last2</th>\n",
       "      <th>trade_size_last2</th>\n",
       "      <th>trade_type_last2</th>\n",
       "      <th>curve_based_price_last2</th>\n",
       "      <th>received_time_diff_last3</th>\n",
       "      <th>trade_price_last3</th>\n",
       "      <th>trade_size_last3</th>\n",
       "      <th>trade_type_last3</th>\n",
       "      <th>curve_based_price_last3</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>101104</td>\n",
       "      <td>5380</td>\n",
       "      <td>104.3191</td>\n",
       "      <td>6.375</td>\n",
       "      <td>1.072349</td>\n",
       "      <td>0</td>\n",
       "      <td>38.639</td>\n",
       "      <td>40000</td>\n",
       "      <td>4</td>\n",
       "      <td>104.202618</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>101105</td>\n",
       "      <td>5380</td>\n",
       "      <td>104.3191</td>\n",
       "      <td>6.375</td>\n",
       "      <td>1.072349</td>\n",
       "      <td>0</td>\n",
       "      <td>38.844</td>\n",
       "      <td>40000</td>\n",
       "      <td>2</td>\n",
       "      <td>104.202618</td>\n",
       "      <td>...</td>\n",
       "      <td>28.0</td>\n",
       "      <td>104.3591</td>\n",
       "      <td>40000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>104.202618</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>101106</td>\n",
       "      <td>5380</td>\n",
       "      <td>104.3190</td>\n",
       "      <td>6.375</td>\n",
       "      <td>1.072257</td>\n",
       "      <td>0</td>\n",
       "      <td>117.423</td>\n",
       "      <td>6000</td>\n",
       "      <td>2</td>\n",
       "      <td>104.364239</td>\n",
       "      <td>...</td>\n",
       "      <td>2923.0</td>\n",
       "      <td>104.3191</td>\n",
       "      <td>40000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>104.202618</td>\n",
       "      <td>2951.0</td>\n",
       "      <td>104.3591</td>\n",
       "      <td>40000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>104.202618</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>101107</td>\n",
       "      <td>5380</td>\n",
       "      <td>103.9280</td>\n",
       "      <td>6.375</td>\n",
       "      <td>1.072123</td>\n",
       "      <td>0</td>\n",
       "      <td>30.532</td>\n",
       "      <td>10000</td>\n",
       "      <td>2</td>\n",
       "      <td>104.431633</td>\n",
       "      <td>...</td>\n",
       "      <td>7145.0</td>\n",
       "      <td>104.3191</td>\n",
       "      <td>40000.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>104.202618</td>\n",
       "      <td>7145.0</td>\n",
       "      <td>104.3191</td>\n",
       "      <td>40000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>104.202618</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>101108</td>\n",
       "      <td>5380</td>\n",
       "      <td>103.6930</td>\n",
       "      <td>6.375</td>\n",
       "      <td>1.071774</td>\n",
       "      <td>0</td>\n",
       "      <td>2.686</td>\n",
       "      <td>10000</td>\n",
       "      <td>2</td>\n",
       "      <td>104.535467</td>\n",
       "      <td>...</td>\n",
       "      <td>15213.0</td>\n",
       "      <td>104.3190</td>\n",
       "      <td>6000.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>104.364239</td>\n",
       "      <td>18136.0</td>\n",
       "      <td>104.3191</td>\n",
       "      <td>40000.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>104.202618</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 25 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   Unnamed: 0  bond_id  trade_price  current_coupon  time_to_maturity  \\\n",
       "0      101104     5380     104.3191           6.375          1.072349   \n",
       "1      101105     5380     104.3191           6.375          1.072349   \n",
       "2      101106     5380     104.3190           6.375          1.072257   \n",
       "3      101107     5380     103.9280           6.375          1.072123   \n",
       "4      101108     5380     103.6930           6.375          1.071774   \n",
       "\n",
       "   is_callable  reporting_delay  trade_size  trade_type  curve_based_price  \\\n",
       "0            0           38.639       40000           4         104.202618   \n",
       "1            0           38.844       40000           2         104.202618   \n",
       "2            0          117.423        6000           2         104.364239   \n",
       "3            0           30.532       10000           2         104.431633   \n",
       "4            0            2.686       10000           2         104.535467   \n",
       "\n",
       "   ...  received_time_diff_last2  trade_price_last2  trade_size_last2  \\\n",
       "0  ...                       NaN                NaN               NaN   \n",
       "1  ...                      28.0           104.3591           40000.0   \n",
       "2  ...                    2923.0           104.3191           40000.0   \n",
       "3  ...                    7145.0           104.3191           40000.0   \n",
       "4  ...                   15213.0           104.3190            6000.0   \n",
       "\n",
       "   trade_type_last2  curve_based_price_last2  received_time_diff_last3  \\\n",
       "0               NaN                      NaN                       NaN   \n",
       "1               4.0               104.202618                       NaN   \n",
       "2               4.0               104.202618                    2951.0   \n",
       "3               2.0               104.202618                    7145.0   \n",
       "4               2.0               104.364239                   18136.0   \n",
       "\n",
       "   trade_price_last3  trade_size_last3  trade_type_last3  \\\n",
       "0                NaN               NaN               NaN   \n",
       "1                NaN               NaN               NaN   \n",
       "2           104.3591           40000.0               4.0   \n",
       "3           104.3191           40000.0               4.0   \n",
       "4           104.3191           40000.0               2.0   \n",
       "\n",
       "   curve_based_price_last3  \n",
       "0                      NaN  \n",
       "1                      NaN  \n",
       "2               104.202618  \n",
       "3               104.202618  \n",
       "4               104.202618  \n",
       "\n",
       "[5 rows x 25 columns]"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train_data = pd.read_excel('BondPrices.xlsx')\n",
    "train_data.head()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "9cfe9eea",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(100005, 25)"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train_data.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "a52d8439",
   "metadata": {},
   "outputs": [],
   "source": [
    "data_sample = train_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "fa5856ed",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>bond_id</th>\n",
       "      <th>trade_price</th>\n",
       "      <th>current_coupon</th>\n",
       "      <th>time_to_maturity</th>\n",
       "      <th>is_callable</th>\n",
       "      <th>reporting_delay</th>\n",
       "      <th>trade_size</th>\n",
       "      <th>trade_type</th>\n",
       "      <th>curve_based_price</th>\n",
       "      <th>...</th>\n",
       "      <th>received_time_diff_last2</th>\n",
       "      <th>trade_price_last2</th>\n",
       "      <th>trade_size_last2</th>\n",
       "      <th>trade_type_last2</th>\n",
       "      <th>curve_based_price_last2</th>\n",
       "      <th>received_time_diff_last3</th>\n",
       "      <th>trade_price_last3</th>\n",
       "      <th>trade_size_last3</th>\n",
       "      <th>trade_type_last3</th>\n",
       "      <th>curve_based_price_last3</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>100000</th>\n",
       "      <td>201104</td>\n",
       "      <td>8347</td>\n",
       "      <td>99.150</td>\n",
       "      <td>4.75</td>\n",
       "      <td>3.775962</td>\n",
       "      <td>0</td>\n",
       "      <td>12.751</td>\n",
       "      <td>19000</td>\n",
       "      <td>4</td>\n",
       "      <td>101.533815</td>\n",
       "      <td>...</td>\n",
       "      <td>601507.0</td>\n",
       "      <td>99.757000</td>\n",
       "      <td>10000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>101.264025</td>\n",
       "      <td>601507.0</td>\n",
       "      <td>99.757000</td>\n",
       "      <td>10000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>101.264025</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100001</th>\n",
       "      <td>201105</td>\n",
       "      <td>8347</td>\n",
       "      <td>101.312</td>\n",
       "      <td>4.75</td>\n",
       "      <td>3.762565</td>\n",
       "      <td>0</td>\n",
       "      <td>269.075</td>\n",
       "      <td>19000</td>\n",
       "      <td>4</td>\n",
       "      <td>102.328828</td>\n",
       "      <td>...</td>\n",
       "      <td>422488.0</td>\n",
       "      <td>98.992105</td>\n",
       "      <td>19000.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>101.533815</td>\n",
       "      <td>1023995.0</td>\n",
       "      <td>99.757000</td>\n",
       "      <td>10000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>101.264025</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100002</th>\n",
       "      <td>201106</td>\n",
       "      <td>8347</td>\n",
       "      <td>102.250</td>\n",
       "      <td>4.75</td>\n",
       "      <td>3.762313</td>\n",
       "      <td>0</td>\n",
       "      <td>8.366</td>\n",
       "      <td>19000</td>\n",
       "      <td>3</td>\n",
       "      <td>102.431196</td>\n",
       "      <td>...</td>\n",
       "      <td>430423.0</td>\n",
       "      <td>99.150000</td>\n",
       "      <td>19000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>101.533815</td>\n",
       "      <td>430423.0</td>\n",
       "      <td>98.992105</td>\n",
       "      <td>19000.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>101.533815</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100003</th>\n",
       "      <td>201107</td>\n",
       "      <td>8347</td>\n",
       "      <td>105.020</td>\n",
       "      <td>4.75</td>\n",
       "      <td>3.756416</td>\n",
       "      <td>0</td>\n",
       "      <td>5.747</td>\n",
       "      <td>10000</td>\n",
       "      <td>3</td>\n",
       "      <td>103.028539</td>\n",
       "      <td>...</td>\n",
       "      <td>193902.0</td>\n",
       "      <td>101.312000</td>\n",
       "      <td>19000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>102.328828</td>\n",
       "      <td>616390.0</td>\n",
       "      <td>99.150000</td>\n",
       "      <td>19000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>101.533815</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100004</th>\n",
       "      <td>201108</td>\n",
       "      <td>8347</td>\n",
       "      <td>104.161</td>\n",
       "      <td>4.75</td>\n",
       "      <td>3.756416</td>\n",
       "      <td>0</td>\n",
       "      <td>19.251</td>\n",
       "      <td>10000</td>\n",
       "      <td>4</td>\n",
       "      <td>103.028539</td>\n",
       "      <td>...</td>\n",
       "      <td>185980.0</td>\n",
       "      <td>102.250000</td>\n",
       "      <td>19000.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>102.431196</td>\n",
       "      <td>193916.0</td>\n",
       "      <td>101.312000</td>\n",
       "      <td>19000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>102.328828</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 25 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        Unnamed: 0  bond_id  trade_price  current_coupon  time_to_maturity  \\\n",
       "100000      201104     8347       99.150            4.75          3.775962   \n",
       "100001      201105     8347      101.312            4.75          3.762565   \n",
       "100002      201106     8347      102.250            4.75          3.762313   \n",
       "100003      201107     8347      105.020            4.75          3.756416   \n",
       "100004      201108     8347      104.161            4.75          3.756416   \n",
       "\n",
       "        is_callable  reporting_delay  trade_size  trade_type  \\\n",
       "100000            0           12.751       19000           4   \n",
       "100001            0          269.075       19000           4   \n",
       "100002            0            8.366       19000           3   \n",
       "100003            0            5.747       10000           3   \n",
       "100004            0           19.251       10000           4   \n",
       "\n",
       "        curve_based_price  ...  received_time_diff_last2  trade_price_last2  \\\n",
       "100000         101.533815  ...                  601507.0          99.757000   \n",
       "100001         102.328828  ...                  422488.0          98.992105   \n",
       "100002         102.431196  ...                  430423.0          99.150000   \n",
       "100003         103.028539  ...                  193902.0         101.312000   \n",
       "100004         103.028539  ...                  185980.0         102.250000   \n",
       "\n",
       "        trade_size_last2  trade_type_last2  curve_based_price_last2  \\\n",
       "100000           10000.0               4.0               101.264025   \n",
       "100001           19000.0               2.0               101.533815   \n",
       "100002           19000.0               4.0               101.533815   \n",
       "100003           19000.0               4.0               102.328828   \n",
       "100004           19000.0               3.0               102.431196   \n",
       "\n",
       "        received_time_diff_last3  trade_price_last3  trade_size_last3  \\\n",
       "100000                  601507.0          99.757000           10000.0   \n",
       "100001                 1023995.0          99.757000           10000.0   \n",
       "100002                  430423.0          98.992105           19000.0   \n",
       "100003                  616390.0          99.150000           19000.0   \n",
       "100004                  193916.0         101.312000           19000.0   \n",
       "\n",
       "        trade_type_last3  curve_based_price_last3  \n",
       "100000               4.0               101.264025  \n",
       "100001               4.0               101.264025  \n",
       "100002               2.0               101.533815  \n",
       "100003               4.0               101.533815  \n",
       "100004               4.0               102.328828  \n",
       "\n",
       "[5 rows x 25 columns]"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data_sample.tail()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "8f0766be",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "437"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "len(data_sample['bond_id'].unique())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "d2ffb67d",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 100005 entries, 0 to 100004\n",
      "Data columns (total 25 columns):\n",
      " #   Column                    Non-Null Count   Dtype  \n",
      "---  ------                    --------------   -----  \n",
      " 0   Unnamed: 0                100005 non-null  int64  \n",
      " 1   bond_id                   100005 non-null  int64  \n",
      " 2   trade_price               100005 non-null  float64\n",
      " 3   current_coupon            100005 non-null  float64\n",
      " 4   time_to_maturity          100005 non-null  float64\n",
      " 5   is_callable               100005 non-null  int64  \n",
      " 6   reporting_delay           100005 non-null  float64\n",
      " 7   trade_size                100005 non-null  int64  \n",
      " 8   trade_type                100005 non-null  int64  \n",
      " 9   curve_based_price         100005 non-null  float64\n",
      " 10  received_time_diff_last1  100005 non-null  int64  \n",
      " 11  trade_price_last1         100005 non-null  float64\n",
      " 12  trade_size_last1          100005 non-null  int64  \n",
      " 13  trade_type_last1          100005 non-null  int64  \n",
      " 14  curve_based_price_last1   100005 non-null  float64\n",
      " 15  received_time_diff_last2  99791 non-null   float64\n",
      " 16  trade_price_last2         99791 non-null   float64\n",
      " 17  trade_size_last2          99791 non-null   float64\n",
      " 18  trade_type_last2          99791 non-null   float64\n",
      " 19  curve_based_price_last2   99791 non-null   float64\n",
      " 20  received_time_diff_last3  99574 non-null   float64\n",
      " 21  trade_price_last3         99574 non-null   float64\n",
      " 22  trade_size_last3          99574 non-null   float64\n",
      " 23  trade_type_last3          99574 non-null   float64\n",
      " 24  curve_based_price_last3   99574 non-null   float64\n",
      "dtypes: float64(17), int64(8)\n",
      "memory usage: 19.1 MB\n"
     ]
    }
   ],
   "source": [
    "data_sample.info()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1faa3ae0",
   "metadata": {},
   "source": [
    "# Data Analysis"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "ff56d58a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 360x360 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.figure(figsize=(5,5))\n",
    "plt.hist(data_sample['trade_price'], bins=40)\n",
    "plt.boxplot(data_sample['trade_price'])\n",
    "plt.xlabel('Price')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "14e675f0",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 360x360 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.figure(figsize=(5,5))\n",
    "plt.boxplot(data_sample['trade_price'], vert = False)\n",
    "plt.xlabel('Price')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1f7dc128",
   "metadata": {},
   "source": [
    "The above diagram shows the distribution of trade prices follows a Gaussian distribution which has long tails indicating many outliers.The box plot shows that the median trade price is around $102."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "7a6bde1b",
   "metadata": {},
   "outputs": [],
   "source": [
    "is_callable = data_sample[data_sample['is_callable'] == 1]\n",
    "is_not_callable = data_sample[data_sample['is_callable'] == 0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "90412c98",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 360x360 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.figure(figsize=(5,5))\n",
    "plt.boxplot(is_callable['current_coupon'], vert = False)\n",
    "plt.xlabel('Callable Bonds Coupon Rate')\n",
    "#plt.boxplot(is_not_callable['current_coupon'], vert = False)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "ae9d8f93",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 360x360 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.figure(figsize=(5,5))\n",
    "#plt.boxplot(is_callable['current_coupon'], vert = False)\n",
    "plt.boxplot(is_not_callable['current_coupon'], vert = False)\n",
    "plt.xlabel('Non-Callable Bonds Coupon Rate')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "89fc096e",
   "metadata": {},
   "source": [
    "Here also we see that the coupons follow Gaussian distribution but with fatter tails.The median coupon of callable bond is significantly higher than not callable bond as expected."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f6471edf",
   "metadata": {},
   "source": [
    "# Feature Engineering"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "adaadc60",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>bond_id</th>\n",
       "      <th>trade_price</th>\n",
       "      <th>current_coupon</th>\n",
       "      <th>time_to_maturity</th>\n",
       "      <th>is_callable</th>\n",
       "      <th>reporting_delay</th>\n",
       "      <th>trade_size</th>\n",
       "      <th>trade_type</th>\n",
       "      <th>curve_based_price</th>\n",
       "      <th>...</th>\n",
       "      <th>received_time_diff_last2</th>\n",
       "      <th>trade_price_last2</th>\n",
       "      <th>trade_size_last2</th>\n",
       "      <th>trade_type_last2</th>\n",
       "      <th>curve_based_price_last2</th>\n",
       "      <th>received_time_diff_last3</th>\n",
       "      <th>trade_price_last3</th>\n",
       "      <th>trade_size_last3</th>\n",
       "      <th>trade_type_last3</th>\n",
       "      <th>curve_based_price_last3</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>101104</td>\n",
       "      <td>5380</td>\n",
       "      <td>104.3191</td>\n",
       "      <td>6.375</td>\n",
       "      <td>1.072349</td>\n",
       "      <td>0</td>\n",
       "      <td>38.639</td>\n",
       "      <td>40000</td>\n",
       "      <td>4</td>\n",
       "      <td>104.202618</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>101105</td>\n",
       "      <td>5380</td>\n",
       "      <td>104.3191</td>\n",
       "      <td>6.375</td>\n",
       "      <td>1.072349</td>\n",
       "      <td>0</td>\n",
       "      <td>38.844</td>\n",
       "      <td>40000</td>\n",
       "      <td>2</td>\n",
       "      <td>104.202618</td>\n",
       "      <td>...</td>\n",
       "      <td>28.0</td>\n",
       "      <td>104.359100</td>\n",
       "      <td>40000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>104.202618</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>101106</td>\n",
       "      <td>5380</td>\n",
       "      <td>104.3190</td>\n",
       "      <td>6.375</td>\n",
       "      <td>1.072257</td>\n",
       "      <td>0</td>\n",
       "      <td>117.423</td>\n",
       "      <td>6000</td>\n",
       "      <td>2</td>\n",
       "      <td>104.364239</td>\n",
       "      <td>...</td>\n",
       "      <td>2923.0</td>\n",
       "      <td>104.319100</td>\n",
       "      <td>40000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>104.202618</td>\n",
       "      <td>2951.0</td>\n",
       "      <td>104.359100</td>\n",
       "      <td>40000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>104.202618</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>101107</td>\n",
       "      <td>5380</td>\n",
       "      <td>103.9280</td>\n",
       "      <td>6.375</td>\n",
       "      <td>1.072123</td>\n",
       "      <td>0</td>\n",
       "      <td>30.532</td>\n",
       "      <td>10000</td>\n",
       "      <td>2</td>\n",
       "      <td>104.431633</td>\n",
       "      <td>...</td>\n",
       "      <td>7145.0</td>\n",
       "      <td>104.319100</td>\n",
       "      <td>40000.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>104.202618</td>\n",
       "      <td>7145.0</td>\n",
       "      <td>104.319100</td>\n",
       "      <td>40000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>104.202618</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>101108</td>\n",
       "      <td>5380</td>\n",
       "      <td>103.6930</td>\n",
       "      <td>6.375</td>\n",
       "      <td>1.071774</td>\n",
       "      <td>0</td>\n",
       "      <td>2.686</td>\n",
       "      <td>10000</td>\n",
       "      <td>2</td>\n",
       "      <td>104.535467</td>\n",
       "      <td>...</td>\n",
       "      <td>15213.0</td>\n",
       "      <td>104.319000</td>\n",
       "      <td>6000.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>104.364239</td>\n",
       "      <td>18136.0</td>\n",
       "      <td>104.319100</td>\n",
       "      <td>40000.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>104.202618</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100000</th>\n",
       "      <td>201104</td>\n",
       "      <td>8347</td>\n",
       "      <td>99.1500</td>\n",
       "      <td>4.750</td>\n",
       "      <td>3.775962</td>\n",
       "      <td>0</td>\n",
       "      <td>12.751</td>\n",
       "      <td>19000</td>\n",
       "      <td>4</td>\n",
       "      <td>101.533815</td>\n",
       "      <td>...</td>\n",
       "      <td>601507.0</td>\n",
       "      <td>99.757000</td>\n",
       "      <td>10000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>101.264025</td>\n",
       "      <td>601507.0</td>\n",
       "      <td>99.757000</td>\n",
       "      <td>10000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>101.264025</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100001</th>\n",
       "      <td>201105</td>\n",
       "      <td>8347</td>\n",
       "      <td>101.3120</td>\n",
       "      <td>4.750</td>\n",
       "      <td>3.762565</td>\n",
       "      <td>0</td>\n",
       "      <td>269.075</td>\n",
       "      <td>19000</td>\n",
       "      <td>4</td>\n",
       "      <td>102.328828</td>\n",
       "      <td>...</td>\n",
       "      <td>422488.0</td>\n",
       "      <td>98.992105</td>\n",
       "      <td>19000.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>101.533815</td>\n",
       "      <td>1023995.0</td>\n",
       "      <td>99.757000</td>\n",
       "      <td>10000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>101.264025</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100002</th>\n",
       "      <td>201106</td>\n",
       "      <td>8347</td>\n",
       "      <td>102.2500</td>\n",
       "      <td>4.750</td>\n",
       "      <td>3.762313</td>\n",
       "      <td>0</td>\n",
       "      <td>8.366</td>\n",
       "      <td>19000</td>\n",
       "      <td>3</td>\n",
       "      <td>102.431196</td>\n",
       "      <td>...</td>\n",
       "      <td>430423.0</td>\n",
       "      <td>99.150000</td>\n",
       "      <td>19000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>101.533815</td>\n",
       "      <td>430423.0</td>\n",
       "      <td>98.992105</td>\n",
       "      <td>19000.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>101.533815</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100003</th>\n",
       "      <td>201107</td>\n",
       "      <td>8347</td>\n",
       "      <td>105.0200</td>\n",
       "      <td>4.750</td>\n",
       "      <td>3.756416</td>\n",
       "      <td>0</td>\n",
       "      <td>5.747</td>\n",
       "      <td>10000</td>\n",
       "      <td>3</td>\n",
       "      <td>103.028539</td>\n",
       "      <td>...</td>\n",
       "      <td>193902.0</td>\n",
       "      <td>101.312000</td>\n",
       "      <td>19000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>102.328828</td>\n",
       "      <td>616390.0</td>\n",
       "      <td>99.150000</td>\n",
       "      <td>19000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>101.533815</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100004</th>\n",
       "      <td>201108</td>\n",
       "      <td>8347</td>\n",
       "      <td>104.1610</td>\n",
       "      <td>4.750</td>\n",
       "      <td>3.756416</td>\n",
       "      <td>0</td>\n",
       "      <td>19.251</td>\n",
       "      <td>10000</td>\n",
       "      <td>4</td>\n",
       "      <td>103.028539</td>\n",
       "      <td>...</td>\n",
       "      <td>185980.0</td>\n",
       "      <td>102.250000</td>\n",
       "      <td>19000.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>102.431196</td>\n",
       "      <td>193916.0</td>\n",
       "      <td>101.312000</td>\n",
       "      <td>19000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>102.328828</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>100005 rows × 25 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        Unnamed: 0  bond_id  trade_price  current_coupon  time_to_maturity  \\\n",
       "0           101104     5380     104.3191           6.375          1.072349   \n",
       "1           101105     5380     104.3191           6.375          1.072349   \n",
       "2           101106     5380     104.3190           6.375          1.072257   \n",
       "3           101107     5380     103.9280           6.375          1.072123   \n",
       "4           101108     5380     103.6930           6.375          1.071774   \n",
       "...            ...      ...          ...             ...               ...   \n",
       "100000      201104     8347      99.1500           4.750          3.775962   \n",
       "100001      201105     8347     101.3120           4.750          3.762565   \n",
       "100002      201106     8347     102.2500           4.750          3.762313   \n",
       "100003      201107     8347     105.0200           4.750          3.756416   \n",
       "100004      201108     8347     104.1610           4.750          3.756416   \n",
       "\n",
       "        is_callable  reporting_delay  trade_size  trade_type  \\\n",
       "0                 0           38.639       40000           4   \n",
       "1                 0           38.844       40000           2   \n",
       "2                 0          117.423        6000           2   \n",
       "3                 0           30.532       10000           2   \n",
       "4                 0            2.686       10000           2   \n",
       "...             ...              ...         ...         ...   \n",
       "100000            0           12.751       19000           4   \n",
       "100001            0          269.075       19000           4   \n",
       "100002            0            8.366       19000           3   \n",
       "100003            0            5.747       10000           3   \n",
       "100004            0           19.251       10000           4   \n",
       "\n",
       "        curve_based_price  ...  received_time_diff_last2  trade_price_last2  \\\n",
       "0              104.202618  ...                       NaN                NaN   \n",
       "1              104.202618  ...                      28.0         104.359100   \n",
       "2              104.364239  ...                    2923.0         104.319100   \n",
       "3              104.431633  ...                    7145.0         104.319100   \n",
       "4              104.535467  ...                   15213.0         104.319000   \n",
       "...                   ...  ...                       ...                ...   \n",
       "100000         101.533815  ...                  601507.0          99.757000   \n",
       "100001         102.328828  ...                  422488.0          98.992105   \n",
       "100002         102.431196  ...                  430423.0          99.150000   \n",
       "100003         103.028539  ...                  193902.0         101.312000   \n",
       "100004         103.028539  ...                  185980.0         102.250000   \n",
       "\n",
       "        trade_size_last2  trade_type_last2  curve_based_price_last2  \\\n",
       "0                    NaN               NaN                      NaN   \n",
       "1                40000.0               4.0               104.202618   \n",
       "2                40000.0               4.0               104.202618   \n",
       "3                40000.0               2.0               104.202618   \n",
       "4                 6000.0               2.0               104.364239   \n",
       "...                  ...               ...                      ...   \n",
       "100000           10000.0               4.0               101.264025   \n",
       "100001           19000.0               2.0               101.533815   \n",
       "100002           19000.0               4.0               101.533815   \n",
       "100003           19000.0               4.0               102.328828   \n",
       "100004           19000.0               3.0               102.431196   \n",
       "\n",
       "        received_time_diff_last3  trade_price_last3  trade_size_last3  \\\n",
       "0                            NaN                NaN               NaN   \n",
       "1                            NaN                NaN               NaN   \n",
       "2                         2951.0         104.359100           40000.0   \n",
       "3                         7145.0         104.319100           40000.0   \n",
       "4                        18136.0         104.319100           40000.0   \n",
       "...                          ...                ...               ...   \n",
       "100000                  601507.0          99.757000           10000.0   \n",
       "100001                 1023995.0          99.757000           10000.0   \n",
       "100002                  430423.0          98.992105           19000.0   \n",
       "100003                  616390.0          99.150000           19000.0   \n",
       "100004                  193916.0         101.312000           19000.0   \n",
       "\n",
       "        trade_type_last3  curve_based_price_last3  \n",
       "0                    NaN                      NaN  \n",
       "1                    NaN                      NaN  \n",
       "2                    4.0               104.202618  \n",
       "3                    4.0               104.202618  \n",
       "4                    2.0               104.202618  \n",
       "...                  ...                      ...  \n",
       "100000               4.0               101.264025  \n",
       "100001               4.0               101.264025  \n",
       "100002               2.0               101.533815  \n",
       "100003               4.0               101.533815  \n",
       "100004               4.0               102.328828  \n",
       "\n",
       "[100005 rows x 25 columns]"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data_sample"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "4c70fc71",
   "metadata": {},
   "outputs": [],
   "source": [
    "data_sample = data_sample.drop(['bond_id'], axis = 1)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "8f89a050",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(100005, 24)"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data_sample.shape\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "02e17cc5",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Unnamed: 0                    0\n",
       "trade_price                   0\n",
       "current_coupon                0\n",
       "time_to_maturity              0\n",
       "is_callable                   0\n",
       "reporting_delay               0\n",
       "trade_size                    0\n",
       "trade_type                    0\n",
       "curve_based_price             0\n",
       "received_time_diff_last1      0\n",
       "trade_price_last1             0\n",
       "trade_size_last1              0\n",
       "trade_type_last1              0\n",
       "curve_based_price_last1       0\n",
       "received_time_diff_last2    214\n",
       "trade_price_last2           214\n",
       "trade_size_last2            214\n",
       "trade_type_last2            214\n",
       "curve_based_price_last2     214\n",
       "received_time_diff_last3    431\n",
       "trade_price_last3           431\n",
       "trade_size_last3            431\n",
       "trade_type_last3            431\n",
       "curve_based_price_last3     431\n",
       "dtype: int64"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data_sample.isna().sum()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "0f2c3b38",
   "metadata": {},
   "outputs": [],
   "source": [
    "train = data_sample.iloc[:80000,:]\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "1ef582e2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>trade_price</th>\n",
       "      <th>current_coupon</th>\n",
       "      <th>time_to_maturity</th>\n",
       "      <th>is_callable</th>\n",
       "      <th>reporting_delay</th>\n",
       "      <th>trade_size</th>\n",
       "      <th>trade_type</th>\n",
       "      <th>curve_based_price</th>\n",
       "      <th>received_time_diff_last1</th>\n",
       "      <th>...</th>\n",
       "      <th>received_time_diff_last2</th>\n",
       "      <th>trade_price_last2</th>\n",
       "      <th>trade_size_last2</th>\n",
       "      <th>trade_type_last2</th>\n",
       "      <th>curve_based_price_last2</th>\n",
       "      <th>received_time_diff_last3</th>\n",
       "      <th>trade_price_last3</th>\n",
       "      <th>trade_size_last3</th>\n",
       "      <th>trade_type_last3</th>\n",
       "      <th>curve_based_price_last3</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>101104</td>\n",
       "      <td>104.3191</td>\n",
       "      <td>6.375</td>\n",
       "      <td>1.072349</td>\n",
       "      <td>0</td>\n",
       "      <td>38.639</td>\n",
       "      <td>40000</td>\n",
       "      <td>4</td>\n",
       "      <td>104.202618</td>\n",
       "      <td>27</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>101105</td>\n",
       "      <td>104.3191</td>\n",
       "      <td>6.375</td>\n",
       "      <td>1.072349</td>\n",
       "      <td>0</td>\n",
       "      <td>38.844</td>\n",
       "      <td>40000</td>\n",
       "      <td>2</td>\n",
       "      <td>104.202618</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>28.0</td>\n",
       "      <td>104.3591</td>\n",
       "      <td>40000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>104.202618</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>101106</td>\n",
       "      <td>104.3190</td>\n",
       "      <td>6.375</td>\n",
       "      <td>1.072257</td>\n",
       "      <td>0</td>\n",
       "      <td>117.423</td>\n",
       "      <td>6000</td>\n",
       "      <td>2</td>\n",
       "      <td>104.364239</td>\n",
       "      <td>2923</td>\n",
       "      <td>...</td>\n",
       "      <td>2923.0</td>\n",
       "      <td>104.3191</td>\n",
       "      <td>40000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>104.202618</td>\n",
       "      <td>2951.0</td>\n",
       "      <td>104.3591</td>\n",
       "      <td>40000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>104.202618</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>101107</td>\n",
       "      <td>103.9280</td>\n",
       "      <td>6.375</td>\n",
       "      <td>1.072123</td>\n",
       "      <td>0</td>\n",
       "      <td>30.532</td>\n",
       "      <td>10000</td>\n",
       "      <td>2</td>\n",
       "      <td>104.431633</td>\n",
       "      <td>4222</td>\n",
       "      <td>...</td>\n",
       "      <td>7145.0</td>\n",
       "      <td>104.3191</td>\n",
       "      <td>40000.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>104.202618</td>\n",
       "      <td>7145.0</td>\n",
       "      <td>104.3191</td>\n",
       "      <td>40000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>104.202618</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>101108</td>\n",
       "      <td>103.6930</td>\n",
       "      <td>6.375</td>\n",
       "      <td>1.071774</td>\n",
       "      <td>0</td>\n",
       "      <td>2.686</td>\n",
       "      <td>10000</td>\n",
       "      <td>2</td>\n",
       "      <td>104.535467</td>\n",
       "      <td>10991</td>\n",
       "      <td>...</td>\n",
       "      <td>15213.0</td>\n",
       "      <td>104.3190</td>\n",
       "      <td>6000.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>104.364239</td>\n",
       "      <td>18136.0</td>\n",
       "      <td>104.3191</td>\n",
       "      <td>40000.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>104.202618</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>79995</th>\n",
       "      <td>181099</td>\n",
       "      <td>101.6110</td>\n",
       "      <td>4.600</td>\n",
       "      <td>1.554054</td>\n",
       "      <td>0</td>\n",
       "      <td>2.172</td>\n",
       "      <td>2000</td>\n",
       "      <td>2</td>\n",
       "      <td>104.335698</td>\n",
       "      <td>2254744</td>\n",
       "      <td>...</td>\n",
       "      <td>2254744.0</td>\n",
       "      <td>104.0250</td>\n",
       "      <td>10000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>104.256861</td>\n",
       "      <td>2254744.0</td>\n",
       "      <td>104.0250</td>\n",
       "      <td>10000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>104.256861</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>79996</th>\n",
       "      <td>181100</td>\n",
       "      <td>101.9930</td>\n",
       "      <td>4.600</td>\n",
       "      <td>1.554054</td>\n",
       "      <td>0</td>\n",
       "      <td>1.003</td>\n",
       "      <td>2000</td>\n",
       "      <td>4</td>\n",
       "      <td>104.335698</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>2254746.0</td>\n",
       "      <td>103.9250</td>\n",
       "      <td>10000.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>104.256861</td>\n",
       "      <td>2254746.0</td>\n",
       "      <td>104.0250</td>\n",
       "      <td>10000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>104.256861</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>79997</th>\n",
       "      <td>181101</td>\n",
       "      <td>104.0280</td>\n",
       "      <td>4.600</td>\n",
       "      <td>1.548565</td>\n",
       "      <td>0</td>\n",
       "      <td>2.338</td>\n",
       "      <td>25000</td>\n",
       "      <td>2</td>\n",
       "      <td>104.654496</td>\n",
       "      <td>173103</td>\n",
       "      <td>...</td>\n",
       "      <td>173105.0</td>\n",
       "      <td>101.6110</td>\n",
       "      <td>2000.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>104.335698</td>\n",
       "      <td>2427849.0</td>\n",
       "      <td>103.9250</td>\n",
       "      <td>10000.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>104.256861</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>79998</th>\n",
       "      <td>181102</td>\n",
       "      <td>104.4200</td>\n",
       "      <td>4.600</td>\n",
       "      <td>1.548565</td>\n",
       "      <td>0</td>\n",
       "      <td>0.767</td>\n",
       "      <td>25000</td>\n",
       "      <td>4</td>\n",
       "      <td>104.654496</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>173104.0</td>\n",
       "      <td>101.9930</td>\n",
       "      <td>2000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>104.335698</td>\n",
       "      <td>173106.0</td>\n",
       "      <td>101.6110</td>\n",
       "      <td>2000.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>104.335698</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>79999</th>\n",
       "      <td>181103</td>\n",
       "      <td>103.7420</td>\n",
       "      <td>4.600</td>\n",
       "      <td>1.537515</td>\n",
       "      <td>0</td>\n",
       "      <td>5.708</td>\n",
       "      <td>25000</td>\n",
       "      <td>2</td>\n",
       "      <td>104.454583</td>\n",
       "      <td>348462</td>\n",
       "      <td>...</td>\n",
       "      <td>348464.0</td>\n",
       "      <td>104.0280</td>\n",
       "      <td>25000.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>104.654496</td>\n",
       "      <td>521567.0</td>\n",
       "      <td>101.9930</td>\n",
       "      <td>2000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>104.335698</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>80000 rows × 24 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       Unnamed: 0  trade_price  current_coupon  time_to_maturity  is_callable  \\\n",
       "0          101104     104.3191           6.375          1.072349            0   \n",
       "1          101105     104.3191           6.375          1.072349            0   \n",
       "2          101106     104.3190           6.375          1.072257            0   \n",
       "3          101107     103.9280           6.375          1.072123            0   \n",
       "4          101108     103.6930           6.375          1.071774            0   \n",
       "...           ...          ...             ...               ...          ...   \n",
       "79995      181099     101.6110           4.600          1.554054            0   \n",
       "79996      181100     101.9930           4.600          1.554054            0   \n",
       "79997      181101     104.0280           4.600          1.548565            0   \n",
       "79998      181102     104.4200           4.600          1.548565            0   \n",
       "79999      181103     103.7420           4.600          1.537515            0   \n",
       "\n",
       "       reporting_delay  trade_size  trade_type  curve_based_price  \\\n",
       "0               38.639       40000           4         104.202618   \n",
       "1               38.844       40000           2         104.202618   \n",
       "2              117.423        6000           2         104.364239   \n",
       "3               30.532       10000           2         104.431633   \n",
       "4                2.686       10000           2         104.535467   \n",
       "...                ...         ...         ...                ...   \n",
       "79995            2.172        2000           2         104.335698   \n",
       "79996            1.003        2000           4         104.335698   \n",
       "79997            2.338       25000           2         104.654496   \n",
       "79998            0.767       25000           4         104.654496   \n",
       "79999            5.708       25000           2         104.454583   \n",
       "\n",
       "       received_time_diff_last1  ...  received_time_diff_last2  \\\n",
       "0                            27  ...                       NaN   \n",
       "1                             0  ...                      28.0   \n",
       "2                          2923  ...                    2923.0   \n",
       "3                          4222  ...                    7145.0   \n",
       "4                         10991  ...                   15213.0   \n",
       "...                         ...  ...                       ...   \n",
       "79995                   2254744  ...                 2254744.0   \n",
       "79996                         1  ...                 2254746.0   \n",
       "79997                    173103  ...                  173105.0   \n",
       "79998                         1  ...                  173104.0   \n",
       "79999                    348462  ...                  348464.0   \n",
       "\n",
       "       trade_price_last2  trade_size_last2  trade_type_last2  \\\n",
       "0                    NaN               NaN               NaN   \n",
       "1               104.3591           40000.0               4.0   \n",
       "2               104.3191           40000.0               4.0   \n",
       "3               104.3191           40000.0               2.0   \n",
       "4               104.3190            6000.0               2.0   \n",
       "...                  ...               ...               ...   \n",
       "79995           104.0250           10000.0               4.0   \n",
       "79996           103.9250           10000.0               2.0   \n",
       "79997           101.6110            2000.0               2.0   \n",
       "79998           101.9930            2000.0               4.0   \n",
       "79999           104.0280           25000.0               2.0   \n",
       "\n",
       "       curve_based_price_last2  received_time_diff_last3  trade_price_last3  \\\n",
       "0                          NaN                       NaN                NaN   \n",
       "1                   104.202618                       NaN                NaN   \n",
       "2                   104.202618                    2951.0           104.3591   \n",
       "3                   104.202618                    7145.0           104.3191   \n",
       "4                   104.364239                   18136.0           104.3191   \n",
       "...                        ...                       ...                ...   \n",
       "79995               104.256861                 2254744.0           104.0250   \n",
       "79996               104.256861                 2254746.0           104.0250   \n",
       "79997               104.335698                 2427849.0           103.9250   \n",
       "79998               104.335698                  173106.0           101.6110   \n",
       "79999               104.654496                  521567.0           101.9930   \n",
       "\n",
       "       trade_size_last3  trade_type_last3  curve_based_price_last3  \n",
       "0                   NaN               NaN                      NaN  \n",
       "1                   NaN               NaN                      NaN  \n",
       "2               40000.0               4.0               104.202618  \n",
       "3               40000.0               4.0               104.202618  \n",
       "4               40000.0               2.0               104.202618  \n",
       "...                 ...               ...                      ...  \n",
       "79995           10000.0               4.0               104.256861  \n",
       "79996           10000.0               4.0               104.256861  \n",
       "79997           10000.0               2.0               104.256861  \n",
       "79998            2000.0               2.0               104.335698  \n",
       "79999            2000.0               4.0               104.335698  \n",
       "\n",
       "[80000 rows x 24 columns]"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "372e6d00",
   "metadata": {},
   "outputs": [],
   "source": [
    "test = data_sample.iloc[80000:, :]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "629b23ee",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>trade_price</th>\n",
       "      <th>current_coupon</th>\n",
       "      <th>time_to_maturity</th>\n",
       "      <th>is_callable</th>\n",
       "      <th>reporting_delay</th>\n",
       "      <th>trade_size</th>\n",
       "      <th>trade_type</th>\n",
       "      <th>curve_based_price</th>\n",
       "      <th>received_time_diff_last1</th>\n",
       "      <th>...</th>\n",
       "      <th>received_time_diff_last2</th>\n",
       "      <th>trade_price_last2</th>\n",
       "      <th>trade_size_last2</th>\n",
       "      <th>trade_type_last2</th>\n",
       "      <th>curve_based_price_last2</th>\n",
       "      <th>received_time_diff_last3</th>\n",
       "      <th>trade_price_last3</th>\n",
       "      <th>trade_size_last3</th>\n",
       "      <th>trade_type_last3</th>\n",
       "      <th>curve_based_price_last3</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>80000</th>\n",
       "      <td>181104</td>\n",
       "      <td>104.242</td>\n",
       "      <td>4.60</td>\n",
       "      <td>1.537515</td>\n",
       "      <td>0</td>\n",
       "      <td>5.811</td>\n",
       "      <td>25000</td>\n",
       "      <td>4</td>\n",
       "      <td>104.454583</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>348463.0</td>\n",
       "      <td>104.420000</td>\n",
       "      <td>25000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>104.654496</td>\n",
       "      <td>348464.0</td>\n",
       "      <td>104.028000</td>\n",
       "      <td>25000.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>104.654496</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>80001</th>\n",
       "      <td>181105</td>\n",
       "      <td>105.000</td>\n",
       "      <td>4.60</td>\n",
       "      <td>1.534894</td>\n",
       "      <td>0</td>\n",
       "      <td>7.282</td>\n",
       "      <td>30000</td>\n",
       "      <td>4</td>\n",
       "      <td>104.257857</td>\n",
       "      <td>82659</td>\n",
       "      <td>...</td>\n",
       "      <td>82659.0</td>\n",
       "      <td>103.742000</td>\n",
       "      <td>25000.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>104.454583</td>\n",
       "      <td>431122.0</td>\n",
       "      <td>104.420000</td>\n",
       "      <td>25000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>104.654496</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>80002</th>\n",
       "      <td>181106</td>\n",
       "      <td>105.000</td>\n",
       "      <td>4.60</td>\n",
       "      <td>1.534894</td>\n",
       "      <td>0</td>\n",
       "      <td>13.389</td>\n",
       "      <td>30000</td>\n",
       "      <td>4</td>\n",
       "      <td>104.257857</td>\n",
       "      <td>6</td>\n",
       "      <td>...</td>\n",
       "      <td>82665.0</td>\n",
       "      <td>104.242000</td>\n",
       "      <td>25000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>104.454583</td>\n",
       "      <td>82665.0</td>\n",
       "      <td>103.742000</td>\n",
       "      <td>25000.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>104.454583</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>80003</th>\n",
       "      <td>181107</td>\n",
       "      <td>105.100</td>\n",
       "      <td>4.60</td>\n",
       "      <td>1.534894</td>\n",
       "      <td>0</td>\n",
       "      <td>13.389</td>\n",
       "      <td>30000</td>\n",
       "      <td>3</td>\n",
       "      <td>104.257857</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>6.0</td>\n",
       "      <td>105.000000</td>\n",
       "      <td>30000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>104.257857</td>\n",
       "      <td>82665.0</td>\n",
       "      <td>104.242000</td>\n",
       "      <td>25000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>104.454583</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>80004</th>\n",
       "      <td>181108</td>\n",
       "      <td>105.275</td>\n",
       "      <td>4.60</td>\n",
       "      <td>1.526627</td>\n",
       "      <td>0</td>\n",
       "      <td>55.435</td>\n",
       "      <td>15000</td>\n",
       "      <td>3</td>\n",
       "      <td>104.470420</td>\n",
       "      <td>260712</td>\n",
       "      <td>...</td>\n",
       "      <td>260712.0</td>\n",
       "      <td>105.000000</td>\n",
       "      <td>30000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>104.257857</td>\n",
       "      <td>260718.0</td>\n",
       "      <td>105.000000</td>\n",
       "      <td>30000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>104.257857</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100000</th>\n",
       "      <td>201104</td>\n",
       "      <td>99.150</td>\n",
       "      <td>4.75</td>\n",
       "      <td>3.775962</td>\n",
       "      <td>0</td>\n",
       "      <td>12.751</td>\n",
       "      <td>19000</td>\n",
       "      <td>4</td>\n",
       "      <td>101.533815</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>601507.0</td>\n",
       "      <td>99.757000</td>\n",
       "      <td>10000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>101.264025</td>\n",
       "      <td>601507.0</td>\n",
       "      <td>99.757000</td>\n",
       "      <td>10000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>101.264025</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100001</th>\n",
       "      <td>201105</td>\n",
       "      <td>101.312</td>\n",
       "      <td>4.75</td>\n",
       "      <td>3.762565</td>\n",
       "      <td>0</td>\n",
       "      <td>269.075</td>\n",
       "      <td>19000</td>\n",
       "      <td>4</td>\n",
       "      <td>102.328828</td>\n",
       "      <td>422488</td>\n",
       "      <td>...</td>\n",
       "      <td>422488.0</td>\n",
       "      <td>98.992105</td>\n",
       "      <td>19000.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>101.533815</td>\n",
       "      <td>1023995.0</td>\n",
       "      <td>99.757000</td>\n",
       "      <td>10000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>101.264025</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100002</th>\n",
       "      <td>201106</td>\n",
       "      <td>102.250</td>\n",
       "      <td>4.75</td>\n",
       "      <td>3.762313</td>\n",
       "      <td>0</td>\n",
       "      <td>8.366</td>\n",
       "      <td>19000</td>\n",
       "      <td>3</td>\n",
       "      <td>102.431196</td>\n",
       "      <td>7935</td>\n",
       "      <td>...</td>\n",
       "      <td>430423.0</td>\n",
       "      <td>99.150000</td>\n",
       "      <td>19000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>101.533815</td>\n",
       "      <td>430423.0</td>\n",
       "      <td>98.992105</td>\n",
       "      <td>19000.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>101.533815</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100003</th>\n",
       "      <td>201107</td>\n",
       "      <td>105.020</td>\n",
       "      <td>4.75</td>\n",
       "      <td>3.756416</td>\n",
       "      <td>0</td>\n",
       "      <td>5.747</td>\n",
       "      <td>10000</td>\n",
       "      <td>3</td>\n",
       "      <td>103.028539</td>\n",
       "      <td>185967</td>\n",
       "      <td>...</td>\n",
       "      <td>193902.0</td>\n",
       "      <td>101.312000</td>\n",
       "      <td>19000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>102.328828</td>\n",
       "      <td>616390.0</td>\n",
       "      <td>99.150000</td>\n",
       "      <td>19000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>101.533815</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100004</th>\n",
       "      <td>201108</td>\n",
       "      <td>104.161</td>\n",
       "      <td>4.75</td>\n",
       "      <td>3.756416</td>\n",
       "      <td>0</td>\n",
       "      <td>19.251</td>\n",
       "      <td>10000</td>\n",
       "      <td>4</td>\n",
       "      <td>103.028539</td>\n",
       "      <td>13</td>\n",
       "      <td>...</td>\n",
       "      <td>185980.0</td>\n",
       "      <td>102.250000</td>\n",
       "      <td>19000.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>102.431196</td>\n",
       "      <td>193916.0</td>\n",
       "      <td>101.312000</td>\n",
       "      <td>19000.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>102.328828</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>20005 rows × 24 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        Unnamed: 0  trade_price  current_coupon  time_to_maturity  \\\n",
       "80000       181104      104.242            4.60          1.537515   \n",
       "80001       181105      105.000            4.60          1.534894   \n",
       "80002       181106      105.000            4.60          1.534894   \n",
       "80003       181107      105.100            4.60          1.534894   \n",
       "80004       181108      105.275            4.60          1.526627   \n",
       "...            ...          ...             ...               ...   \n",
       "100000      201104       99.150            4.75          3.775962   \n",
       "100001      201105      101.312            4.75          3.762565   \n",
       "100002      201106      102.250            4.75          3.762313   \n",
       "100003      201107      105.020            4.75          3.756416   \n",
       "100004      201108      104.161            4.75          3.756416   \n",
       "\n",
       "        is_callable  reporting_delay  trade_size  trade_type  \\\n",
       "80000             0            5.811       25000           4   \n",
       "80001             0            7.282       30000           4   \n",
       "80002             0           13.389       30000           4   \n",
       "80003             0           13.389       30000           3   \n",
       "80004             0           55.435       15000           3   \n",
       "...             ...              ...         ...         ...   \n",
       "100000            0           12.751       19000           4   \n",
       "100001            0          269.075       19000           4   \n",
       "100002            0            8.366       19000           3   \n",
       "100003            0            5.747       10000           3   \n",
       "100004            0           19.251       10000           4   \n",
       "\n",
       "        curve_based_price  received_time_diff_last1  ...  \\\n",
       "80000          104.454583                         0  ...   \n",
       "80001          104.257857                     82659  ...   \n",
       "80002          104.257857                         6  ...   \n",
       "80003          104.257857                         0  ...   \n",
       "80004          104.470420                    260712  ...   \n",
       "...                   ...                       ...  ...   \n",
       "100000         101.533815                         0  ...   \n",
       "100001         102.328828                    422488  ...   \n",
       "100002         102.431196                      7935  ...   \n",
       "100003         103.028539                    185967  ...   \n",
       "100004         103.028539                        13  ...   \n",
       "\n",
       "        received_time_diff_last2  trade_price_last2  trade_size_last2  \\\n",
       "80000                   348463.0         104.420000           25000.0   \n",
       "80001                    82659.0         103.742000           25000.0   \n",
       "80002                    82665.0         104.242000           25000.0   \n",
       "80003                        6.0         105.000000           30000.0   \n",
       "80004                   260712.0         105.000000           30000.0   \n",
       "...                          ...                ...               ...   \n",
       "100000                  601507.0          99.757000           10000.0   \n",
       "100001                  422488.0          98.992105           19000.0   \n",
       "100002                  430423.0          99.150000           19000.0   \n",
       "100003                  193902.0         101.312000           19000.0   \n",
       "100004                  185980.0         102.250000           19000.0   \n",
       "\n",
       "        trade_type_last2  curve_based_price_last2  received_time_diff_last3  \\\n",
       "80000                4.0               104.654496                  348464.0   \n",
       "80001                2.0               104.454583                  431122.0   \n",
       "80002                4.0               104.454583                   82665.0   \n",
       "80003                4.0               104.257857                   82665.0   \n",
       "80004                4.0               104.257857                  260718.0   \n",
       "...                  ...                      ...                       ...   \n",
       "100000               4.0               101.264025                  601507.0   \n",
       "100001               2.0               101.533815                 1023995.0   \n",
       "100002               4.0               101.533815                  430423.0   \n",
       "100003               4.0               102.328828                  616390.0   \n",
       "100004               3.0               102.431196                  193916.0   \n",
       "\n",
       "        trade_price_last3  trade_size_last3  trade_type_last3  \\\n",
       "80000          104.028000           25000.0               2.0   \n",
       "80001          104.420000           25000.0               4.0   \n",
       "80002          103.742000           25000.0               2.0   \n",
       "80003          104.242000           25000.0               4.0   \n",
       "80004          105.000000           30000.0               4.0   \n",
       "...                   ...               ...               ...   \n",
       "100000          99.757000           10000.0               4.0   \n",
       "100001          99.757000           10000.0               4.0   \n",
       "100002          98.992105           19000.0               2.0   \n",
       "100003          99.150000           19000.0               4.0   \n",
       "100004         101.312000           19000.0               4.0   \n",
       "\n",
       "        curve_based_price_last3  \n",
       "80000                104.654496  \n",
       "80001                104.654496  \n",
       "80002                104.454583  \n",
       "80003                104.454583  \n",
       "80004                104.257857  \n",
       "...                         ...  \n",
       "100000               101.264025  \n",
       "100001               101.264025  \n",
       "100002               101.533815  \n",
       "100003               101.533815  \n",
       "100004               102.328828  \n",
       "\n",
       "[20005 rows x 24 columns]"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "test"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "ba4f4492",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Unnamed: 0                    0\n",
       "trade_price                   0\n",
       "current_coupon                0\n",
       "time_to_maturity              0\n",
       "is_callable                   0\n",
       "reporting_delay               0\n",
       "trade_size                    0\n",
       "trade_type                    0\n",
       "curve_based_price             0\n",
       "received_time_diff_last1      0\n",
       "trade_price_last1             0\n",
       "trade_size_last1              0\n",
       "trade_type_last1              0\n",
       "curve_based_price_last1       0\n",
       "received_time_diff_last2    149\n",
       "trade_price_last2           149\n",
       "trade_size_last2            149\n",
       "trade_type_last2            149\n",
       "curve_based_price_last2     149\n",
       "received_time_diff_last3    304\n",
       "trade_price_last3           304\n",
       "trade_size_last3            304\n",
       "trade_type_last3            304\n",
       "curve_based_price_last3     304\n",
       "dtype: int64"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train.isna().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "dfb8e0c7",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Unnamed: 0                    0\n",
       "trade_price                   0\n",
       "current_coupon                0\n",
       "time_to_maturity              0\n",
       "is_callable                   0\n",
       "reporting_delay               0\n",
       "trade_size                    0\n",
       "trade_type                    0\n",
       "curve_based_price             0\n",
       "received_time_diff_last1      0\n",
       "trade_price_last1             0\n",
       "trade_size_last1              0\n",
       "trade_type_last1              0\n",
       "curve_based_price_last1       0\n",
       "received_time_diff_last2     65\n",
       "trade_price_last2            65\n",
       "trade_size_last2             65\n",
       "trade_type_last2             65\n",
       "curve_based_price_last2      65\n",
       "received_time_diff_last3    127\n",
       "trade_price_last3           127\n",
       "trade_size_last3            127\n",
       "trade_type_last3            127\n",
       "curve_based_price_last3     127\n",
       "dtype: int64"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "test.isna().sum()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fd0dc961",
   "metadata": {},
   "source": [
    "# Input & Target Columns\n",
    "Let's select the columns that we'll use for training."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "7bdaabb1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['Unnamed: 0', 'trade_price', 'current_coupon', 'time_to_maturity',\n",
       "       'is_callable', 'reporting_delay', 'trade_size', 'trade_type',\n",
       "       'curve_based_price', 'received_time_diff_last1', 'trade_price_last1',\n",
       "       'trade_size_last1', 'trade_type_last1', 'curve_based_price_last1',\n",
       "       'received_time_diff_last2', 'trade_price_last2', 'trade_size_last2',\n",
       "       'trade_type_last2', 'curve_based_price_last2',\n",
       "       'received_time_diff_last3', 'trade_price_last3', 'trade_size_last3',\n",
       "       'trade_type_last3', 'curve_based_price_last3'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "b317ad7d",
   "metadata": {},
   "outputs": [],
   "source": [
    "inputs_cols = ['current_coupon',\n",
    "       'time_to_maturity', 'is_callable', 'reporting_delay', 'trade_size',\n",
    "       'trade_type', 'curve_based_price', 'received_time_diff_last1',\n",
    "       'trade_price_last1', 'trade_size_last1', 'trade_type_last1',\n",
    "       'curve_based_price_last1', 'received_time_diff_last2',\n",
    "       'trade_price_last2', 'trade_size_last2', 'trade_type_last2',\n",
    "       'curve_based_price_last2', 'received_time_diff_last3',\n",
    "       'trade_price_last3', 'trade_size_last3', 'trade_type_last3',\n",
    "       'curve_based_price_last3']\n",
    "target_col = ['trade_price']\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "075599bc",
   "metadata": {},
   "outputs": [],
   "source": [
    "train_inputs = train[inputs_cols]\n",
    "train_target = train[target_col]\n",
    "test_inputs = test[inputs_cols]\n",
    "test_output = test[target_col]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "efdeb3b2",
   "metadata": {},
   "outputs": [],
   "source": [
    "X_train = train[inputs_cols]\n",
    "y_train = train[target_col]\n",
    "X_test = test[inputs_cols]\n",
    "y_test = test[target_col]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "4ea0b436",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "current_coupon                0\n",
       "time_to_maturity              0\n",
       "is_callable                   0\n",
       "reporting_delay               0\n",
       "trade_size                    0\n",
       "trade_type                    0\n",
       "curve_based_price             0\n",
       "received_time_diff_last1      0\n",
       "trade_price_last1             0\n",
       "trade_size_last1              0\n",
       "trade_type_last1              0\n",
       "curve_based_price_last1       0\n",
       "received_time_diff_last2    149\n",
       "trade_price_last2           149\n",
       "trade_size_last2            149\n",
       "trade_type_last2            149\n",
       "curve_based_price_last2     149\n",
       "received_time_diff_last3    304\n",
       "trade_price_last3           304\n",
       "trade_size_last3            304\n",
       "trade_type_last3            304\n",
       "curve_based_price_last3     304\n",
       "dtype: int64"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X_train.isna().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "249e0485",
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "from statsmodels.stats.outliers_influence import variance_inflation_factor\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "c1f575ed",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Converting the 2d numpy arrays to 1d so that sklearn can compute it.\n",
    "y_train = y_train.values.flatten()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "16d69432",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([104.3191, 104.3191, 104.319 , ..., 104.028 , 104.42  , 103.742 ])"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "y_train\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1917248a",
   "metadata": {},
   "source": [
    "# Identify Numeric & Categorical Columns."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "42d62683",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "22\n"
     ]
    }
   ],
   "source": [
    "numeric_cols = ['current_coupon',\n",
    "       'time_to_maturity', 'reporting_delay', 'trade_size',\n",
    "       'curve_based_price', 'received_time_diff_last1',\n",
    "       'trade_price_last1', 'trade_size_last1',\n",
    "       'curve_based_price_last1', 'received_time_diff_last2',\n",
    "       'trade_price_last2', 'trade_size_last2',\n",
    "       'curve_based_price_last2', 'received_time_diff_last3',\n",
    "       'trade_price_last3', 'trade_size_last3',\n",
    "       'curve_based_price_last3']\n",
    "\n",
    "categorical_cols = ['is_callable', 'trade_type', 'trade_type_last1', 'trade_type_last2', 'trade_type_last3']\n",
    "print(len(numeric_cols) + len(categorical_cols))\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "11a229a5",
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "from statsmodels.tools.tools import add_constant\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9b79e87b",
   "metadata": {},
   "source": [
    "\n",
    "# Impute Missing Numerical Data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "45ca55c7",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "current_coupon                0\n",
       "time_to_maturity              0\n",
       "reporting_delay               0\n",
       "trade_size                    0\n",
       "curve_based_price             0\n",
       "received_time_diff_last1      0\n",
       "trade_price_last1             0\n",
       "trade_size_last1              0\n",
       "curve_based_price_last1       0\n",
       "received_time_diff_last2    149\n",
       "trade_price_last2           149\n",
       "trade_size_last2            149\n",
       "curve_based_price_last2     149\n",
       "received_time_diff_last3    304\n",
       "trade_price_last3           304\n",
       "trade_size_last3            304\n",
       "curve_based_price_last3     304\n",
       "dtype: int64"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X_train[numeric_cols].isna().sum()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "e2668d12",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "current_coupon                0\n",
       "time_to_maturity              0\n",
       "reporting_delay               0\n",
       "trade_size                    0\n",
       "curve_based_price             0\n",
       "received_time_diff_last1      0\n",
       "trade_price_last1             0\n",
       "trade_size_last1              0\n",
       "curve_based_price_last1       0\n",
       "received_time_diff_last2     65\n",
       "trade_price_last2            65\n",
       "trade_size_last2             65\n",
       "curve_based_price_last2      65\n",
       "received_time_diff_last3    127\n",
       "trade_price_last3           127\n",
       "trade_size_last3            127\n",
       "curve_based_price_last3     127\n",
       "dtype: int64"
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X_test[numeric_cols].isna().sum()\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "c7602a93",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.impute import SimpleImputer\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "d0c8eeab",
   "metadata": {},
   "outputs": [],
   "source": [
    "imputer = SimpleImputer(strategy = 'mean').fit(train_data[numeric_cols])\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "d6c8cc7c",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/abhishekakula/opt/anaconda3/lib/python3.8/site-packages/pandas/core/frame.py:3678: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  self[col] = igetitem(value, i)\n",
      "/Users/abhishekakula/opt/anaconda3/lib/python3.8/site-packages/pandas/core/frame.py:3678: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  self[col] = igetitem(value, i)\n"
     ]
    }
   ],
   "source": [
    "X_train[numeric_cols] = imputer.transform(X_train[numeric_cols])\n",
    "X_test[numeric_cols] = imputer.transform(X_test[numeric_cols])\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "73949236",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "current_coupon              0\n",
       "time_to_maturity            0\n",
       "reporting_delay             0\n",
       "trade_size                  0\n",
       "curve_based_price           0\n",
       "received_time_diff_last1    0\n",
       "trade_price_last1           0\n",
       "trade_size_last1            0\n",
       "curve_based_price_last1     0\n",
       "received_time_diff_last2    0\n",
       "trade_price_last2           0\n",
       "trade_size_last2            0\n",
       "curve_based_price_last2     0\n",
       "received_time_diff_last3    0\n",
       "trade_price_last3           0\n",
       "trade_size_last3            0\n",
       "curve_based_price_last3     0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 38,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X_train[numeric_cols].isna().sum()\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "d16f7cb9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "current_coupon              0\n",
       "time_to_maturity            0\n",
       "reporting_delay             0\n",
       "trade_size                  0\n",
       "curve_based_price           0\n",
       "received_time_diff_last1    0\n",
       "trade_price_last1           0\n",
       "trade_size_last1            0\n",
       "curve_based_price_last1     0\n",
       "received_time_diff_last2    0\n",
       "trade_price_last2           0\n",
       "trade_size_last2            0\n",
       "curve_based_price_last2     0\n",
       "received_time_diff_last3    0\n",
       "trade_price_last3           0\n",
       "trade_size_last3            0\n",
       "curve_based_price_last3     0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 39,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X_test[numeric_cols].isna().sum()\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "id": "acdaf5a0",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>current_coupon</th>\n",
       "      <th>time_to_maturity</th>\n",
       "      <th>reporting_delay</th>\n",
       "      <th>trade_size</th>\n",
       "      <th>curve_based_price</th>\n",
       "      <th>received_time_diff_last1</th>\n",
       "      <th>trade_price_last1</th>\n",
       "      <th>trade_size_last1</th>\n",
       "      <th>curve_based_price_last1</th>\n",
       "      <th>received_time_diff_last2</th>\n",
       "      <th>trade_price_last2</th>\n",
       "      <th>trade_size_last2</th>\n",
       "      <th>curve_based_price_last2</th>\n",
       "      <th>received_time_diff_last3</th>\n",
       "      <th>trade_price_last3</th>\n",
       "      <th>trade_size_last3</th>\n",
       "      <th>curve_based_price_last3</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>6.375</td>\n",
       "      <td>1.072349</td>\n",
       "      <td>38.639</td>\n",
       "      <td>40000.0</td>\n",
       "      <td>104.202618</td>\n",
       "      <td>27.0</td>\n",
       "      <td>104.3591</td>\n",
       "      <td>40000.0</td>\n",
       "      <td>104.202618</td>\n",
       "      <td>60719.763476</td>\n",
       "      <td>101.863326</td>\n",
       "      <td>132745.337024</td>\n",
       "      <td>101.725993</td>\n",
       "      <td>89340.30042</td>\n",
       "      <td>101.857961</td>\n",
       "      <td>132181.86391</td>\n",
       "      <td>101.720516</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>6.375</td>\n",
       "      <td>1.072349</td>\n",
       "      <td>38.844</td>\n",
       "      <td>40000.0</td>\n",
       "      <td>104.202618</td>\n",
       "      <td>0.0</td>\n",
       "      <td>104.3191</td>\n",
       "      <td>40000.0</td>\n",
       "      <td>104.202618</td>\n",
       "      <td>28.000000</td>\n",
       "      <td>104.359100</td>\n",
       "      <td>40000.000000</td>\n",
       "      <td>104.202618</td>\n",
       "      <td>89340.30042</td>\n",
       "      <td>101.857961</td>\n",
       "      <td>132181.86391</td>\n",
       "      <td>101.720516</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>6.375</td>\n",
       "      <td>1.072257</td>\n",
       "      <td>117.423</td>\n",
       "      <td>6000.0</td>\n",
       "      <td>104.364239</td>\n",
       "      <td>2923.0</td>\n",
       "      <td>104.3191</td>\n",
       "      <td>40000.0</td>\n",
       "      <td>104.202618</td>\n",
       "      <td>2923.000000</td>\n",
       "      <td>104.319100</td>\n",
       "      <td>40000.000000</td>\n",
       "      <td>104.202618</td>\n",
       "      <td>2951.00000</td>\n",
       "      <td>104.359100</td>\n",
       "      <td>40000.00000</td>\n",
       "      <td>104.202618</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>6.375</td>\n",
       "      <td>1.072123</td>\n",
       "      <td>30.532</td>\n",
       "      <td>10000.0</td>\n",
       "      <td>104.431633</td>\n",
       "      <td>4222.0</td>\n",
       "      <td>104.3190</td>\n",
       "      <td>6000.0</td>\n",
       "      <td>104.364239</td>\n",
       "      <td>7145.000000</td>\n",
       "      <td>104.319100</td>\n",
       "      <td>40000.000000</td>\n",
       "      <td>104.202618</td>\n",
       "      <td>7145.00000</td>\n",
       "      <td>104.319100</td>\n",
       "      <td>40000.00000</td>\n",
       "      <td>104.202618</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>6.375</td>\n",
       "      <td>1.071774</td>\n",
       "      <td>2.686</td>\n",
       "      <td>10000.0</td>\n",
       "      <td>104.535467</td>\n",
       "      <td>10991.0</td>\n",
       "      <td>103.9280</td>\n",
       "      <td>10000.0</td>\n",
       "      <td>104.431633</td>\n",
       "      <td>15213.000000</td>\n",
       "      <td>104.319000</td>\n",
       "      <td>6000.000000</td>\n",
       "      <td>104.364239</td>\n",
       "      <td>18136.00000</td>\n",
       "      <td>104.319100</td>\n",
       "      <td>40000.00000</td>\n",
       "      <td>104.202618</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   current_coupon  time_to_maturity  reporting_delay  trade_size  \\\n",
       "0           6.375          1.072349           38.639     40000.0   \n",
       "1           6.375          1.072349           38.844     40000.0   \n",
       "2           6.375          1.072257          117.423      6000.0   \n",
       "3           6.375          1.072123           30.532     10000.0   \n",
       "4           6.375          1.071774            2.686     10000.0   \n",
       "\n",
       "   curve_based_price  received_time_diff_last1  trade_price_last1  \\\n",
       "0         104.202618                      27.0           104.3591   \n",
       "1         104.202618                       0.0           104.3191   \n",
       "2         104.364239                    2923.0           104.3191   \n",
       "3         104.431633                    4222.0           104.3190   \n",
       "4         104.535467                   10991.0           103.9280   \n",
       "\n",
       "   trade_size_last1  curve_based_price_last1  received_time_diff_last2  \\\n",
       "0           40000.0               104.202618              60719.763476   \n",
       "1           40000.0               104.202618                 28.000000   \n",
       "2           40000.0               104.202618               2923.000000   \n",
       "3            6000.0               104.364239               7145.000000   \n",
       "4           10000.0               104.431633              15213.000000   \n",
       "\n",
       "   trade_price_last2  trade_size_last2  curve_based_price_last2  \\\n",
       "0         101.863326     132745.337024               101.725993   \n",
       "1         104.359100      40000.000000               104.202618   \n",
       "2         104.319100      40000.000000               104.202618   \n",
       "3         104.319100      40000.000000               104.202618   \n",
       "4         104.319000       6000.000000               104.364239   \n",
       "\n",
       "   received_time_diff_last3  trade_price_last3  trade_size_last3  \\\n",
       "0               89340.30042         101.857961      132181.86391   \n",
       "1               89340.30042         101.857961      132181.86391   \n",
       "2                2951.00000         104.359100       40000.00000   \n",
       "3                7145.00000         104.319100       40000.00000   \n",
       "4               18136.00000         104.319100       40000.00000   \n",
       "\n",
       "   curve_based_price_last3  \n",
       "0               101.720516  \n",
       "1               101.720516  \n",
       "2               104.202618  \n",
       "3               104.202618  \n",
       "4               104.202618  "
      ]
     },
     "execution_count": 40,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train_inputs1 = X_train[numeric_cols]\n",
    "train_inputs1.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "id": "9b6068cb",
   "metadata": {},
   "outputs": [],
   "source": [
    "import warnings\n",
    "warnings.filterwarnings('ignore')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "id": "8f43dd2c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "const                        185.960175\n",
       "current_coupon                 1.121832\n",
       "time_to_maturity               1.132437\n",
       "reporting_delay                1.000111\n",
       "trade_size                     1.179734\n",
       "curve_based_price            924.646508\n",
       "received_time_diff_last1       2.153218\n",
       "trade_price_last1             69.881748\n",
       "trade_size_last1               1.300797\n",
       "curve_based_price_last1     1092.822692\n",
       "received_time_diff_last2       4.373137\n",
       "trade_price_last2             83.608524\n",
       "trade_size_last2               1.298604\n",
       "curve_based_price_last2      441.923218\n",
       "received_time_diff_last3       3.226058\n",
       "trade_price_last3             69.356825\n",
       "trade_size_last3               1.176320\n",
       "curve_based_price_last3      249.988549\n",
       "dtype: float64"
      ]
     },
     "execution_count": 42,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X = add_constant(train_inputs1)\n",
    "pd.Series([variance_inflation_factor(X.values, i) \n",
    "               for i in range(X.shape[1])], \n",
    "              index=X.columns)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ebab8574",
   "metadata": {},
   "source": [
    "#Scaling Numeric Features"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "id": "4cb3b938",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.preprocessing import MinMaxScaler\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "id": "5cd123b1",
   "metadata": {},
   "outputs": [],
   "source": [
    "scaler = MinMaxScaler().fit(X_train[numeric_cols])\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "id": "9d88feaf",
   "metadata": {},
   "outputs": [],
   "source": [
    "X_train[numeric_cols] = scaler.transform(X_train[numeric_cols])\n",
    "X_test[numeric_cols] = scaler.transform(X_test[numeric_cols])\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "359d2bba",
   "metadata": {},
   "source": [
    "# Encoding Categorical Data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "id": "0775bc90",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>current_coupon</th>\n",
       "      <th>time_to_maturity</th>\n",
       "      <th>is_callable</th>\n",
       "      <th>reporting_delay</th>\n",
       "      <th>trade_size</th>\n",
       "      <th>trade_type</th>\n",
       "      <th>curve_based_price</th>\n",
       "      <th>received_time_diff_last1</th>\n",
       "      <th>trade_price_last1</th>\n",
       "      <th>trade_size_last1</th>\n",
       "      <th>...</th>\n",
       "      <th>trade_type_last1_3</th>\n",
       "      <th>trade_type_last1_4</th>\n",
       "      <th>trade_type_last2_2.0</th>\n",
       "      <th>trade_type_last2_3.0</th>\n",
       "      <th>trade_type_last2_4.0</th>\n",
       "      <th>trade_type_last2_nan</th>\n",
       "      <th>trade_type_last3_2.0</th>\n",
       "      <th>trade_type_last3_3.0</th>\n",
       "      <th>trade_type_last3_4.0</th>\n",
       "      <th>trade_type_last3_nan</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>80000</th>\n",
       "      <td>0.391489</td>\n",
       "      <td>0.015186</td>\n",
       "      <td>0</td>\n",
       "      <td>5.180258e-07</td>\n",
       "      <td>0.004801</td>\n",
       "      <td>4</td>\n",
       "      <td>0.651455</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.651969</td>\n",
       "      <td>0.004801</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>80001</th>\n",
       "      <td>0.391489</td>\n",
       "      <td>0.015155</td>\n",
       "      <td>0</td>\n",
       "      <td>5.327536e-07</td>\n",
       "      <td>0.005801</td>\n",
       "      <td>4</td>\n",
       "      <td>0.649765</td>\n",
       "      <td>9.869512e-03</td>\n",
       "      <td>0.656217</td>\n",
       "      <td>0.004801</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>80002</th>\n",
       "      <td>0.391489</td>\n",
       "      <td>0.015155</td>\n",
       "      <td>0</td>\n",
       "      <td>5.938975e-07</td>\n",
       "      <td>0.005801</td>\n",
       "      <td>4</td>\n",
       "      <td>0.649765</td>\n",
       "      <td>7.164020e-07</td>\n",
       "      <td>0.662657</td>\n",
       "      <td>0.005801</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>80003</th>\n",
       "      <td>0.391489</td>\n",
       "      <td>0.015155</td>\n",
       "      <td>0</td>\n",
       "      <td>5.938975e-07</td>\n",
       "      <td>0.005801</td>\n",
       "      <td>3</td>\n",
       "      <td>0.649765</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.662657</td>\n",
       "      <td>0.005801</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>80004</th>\n",
       "      <td>0.391489</td>\n",
       "      <td>0.015056</td>\n",
       "      <td>0</td>\n",
       "      <td>1.014866e-06</td>\n",
       "      <td>0.002801</td>\n",
       "      <td>3</td>\n",
       "      <td>0.651591</td>\n",
       "      <td>3.112910e-02</td>\n",
       "      <td>0.663506</td>\n",
       "      <td>0.005801</td>\n",
       "      <td>...</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100000</th>\n",
       "      <td>0.404255</td>\n",
       "      <td>0.041867</td>\n",
       "      <td>0</td>\n",
       "      <td>5.875098e-07</td>\n",
       "      <td>0.003601</td>\n",
       "      <td>4</td>\n",
       "      <td>0.626364</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.611616</td>\n",
       "      <td>0.003601</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100001</th>\n",
       "      <td>0.404255</td>\n",
       "      <td>0.041707</td>\n",
       "      <td>0</td>\n",
       "      <td>3.153850e-06</td>\n",
       "      <td>0.003601</td>\n",
       "      <td>4</td>\n",
       "      <td>0.633194</td>\n",
       "      <td>5.044521e-02</td>\n",
       "      <td>0.612957</td>\n",
       "      <td>0.003601</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100002</th>\n",
       "      <td>0.404255</td>\n",
       "      <td>0.041704</td>\n",
       "      <td>0</td>\n",
       "      <td>5.436067e-07</td>\n",
       "      <td>0.003601</td>\n",
       "      <td>3</td>\n",
       "      <td>0.634073</td>\n",
       "      <td>9.474416e-04</td>\n",
       "      <td>0.631325</td>\n",
       "      <td>0.003601</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100003</th>\n",
       "      <td>0.404255</td>\n",
       "      <td>0.041634</td>\n",
       "      <td>0</td>\n",
       "      <td>5.173851e-07</td>\n",
       "      <td>0.001800</td>\n",
       "      <td>3</td>\n",
       "      <td>0.639204</td>\n",
       "      <td>2.220452e-02</td>\n",
       "      <td>0.639294</td>\n",
       "      <td>0.003601</td>\n",
       "      <td>...</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100004</th>\n",
       "      <td>0.404255</td>\n",
       "      <td>0.041634</td>\n",
       "      <td>0</td>\n",
       "      <td>6.525884e-07</td>\n",
       "      <td>0.001800</td>\n",
       "      <td>4</td>\n",
       "      <td>0.639204</td>\n",
       "      <td>1.552204e-06</td>\n",
       "      <td>0.662827</td>\n",
       "      <td>0.001800</td>\n",
       "      <td>...</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>20005 rows × 38 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        current_coupon  time_to_maturity  is_callable  reporting_delay  \\\n",
       "80000         0.391489          0.015186            0     5.180258e-07   \n",
       "80001         0.391489          0.015155            0     5.327536e-07   \n",
       "80002         0.391489          0.015155            0     5.938975e-07   \n",
       "80003         0.391489          0.015155            0     5.938975e-07   \n",
       "80004         0.391489          0.015056            0     1.014866e-06   \n",
       "...                ...               ...          ...              ...   \n",
       "100000        0.404255          0.041867            0     5.875098e-07   \n",
       "100001        0.404255          0.041707            0     3.153850e-06   \n",
       "100002        0.404255          0.041704            0     5.436067e-07   \n",
       "100003        0.404255          0.041634            0     5.173851e-07   \n",
       "100004        0.404255          0.041634            0     6.525884e-07   \n",
       "\n",
       "        trade_size  trade_type  curve_based_price  received_time_diff_last1  \\\n",
       "80000     0.004801           4           0.651455              0.000000e+00   \n",
       "80001     0.005801           4           0.649765              9.869512e-03   \n",
       "80002     0.005801           4           0.649765              7.164020e-07   \n",
       "80003     0.005801           3           0.649765              0.000000e+00   \n",
       "80004     0.002801           3           0.651591              3.112910e-02   \n",
       "...            ...         ...                ...                       ...   \n",
       "100000    0.003601           4           0.626364              0.000000e+00   \n",
       "100001    0.003601           4           0.633194              5.044521e-02   \n",
       "100002    0.003601           3           0.634073              9.474416e-04   \n",
       "100003    0.001800           3           0.639204              2.220452e-02   \n",
       "100004    0.001800           4           0.639204              1.552204e-06   \n",
       "\n",
       "        trade_price_last1  trade_size_last1  ...  trade_type_last1_3  \\\n",
       "80000            0.651969          0.004801  ...                 0.0   \n",
       "80001            0.656217          0.004801  ...                 0.0   \n",
       "80002            0.662657          0.005801  ...                 0.0   \n",
       "80003            0.662657          0.005801  ...                 0.0   \n",
       "80004            0.663506          0.005801  ...                 1.0   \n",
       "...                   ...               ...  ...                 ...   \n",
       "100000           0.611616          0.003601  ...                 0.0   \n",
       "100001           0.612957          0.003601  ...                 0.0   \n",
       "100002           0.631325          0.003601  ...                 0.0   \n",
       "100003           0.639294          0.003601  ...                 1.0   \n",
       "100004           0.662827          0.001800  ...                 1.0   \n",
       "\n",
       "        trade_type_last1_4  trade_type_last2_2.0  trade_type_last2_3.0  \\\n",
       "80000                  0.0                   0.0                   0.0   \n",
       "80001                  1.0                   1.0                   0.0   \n",
       "80002                  1.0                   0.0                   0.0   \n",
       "80003                  1.0                   0.0                   0.0   \n",
       "80004                  0.0                   0.0                   0.0   \n",
       "...                    ...                   ...                   ...   \n",
       "100000                 0.0                   0.0                   0.0   \n",
       "100001                 1.0                   1.0                   0.0   \n",
       "100002                 1.0                   0.0                   0.0   \n",
       "100003                 0.0                   0.0                   0.0   \n",
       "100004                 0.0                   0.0                   1.0   \n",
       "\n",
       "        trade_type_last2_4.0  trade_type_last2_nan  trade_type_last3_2.0  \\\n",
       "80000                    1.0                   0.0                   1.0   \n",
       "80001                    0.0                   0.0                   0.0   \n",
       "80002                    1.0                   0.0                   1.0   \n",
       "80003                    1.0                   0.0                   0.0   \n",
       "80004                    1.0                   0.0                   0.0   \n",
       "...                      ...                   ...                   ...   \n",
       "100000                   1.0                   0.0                   0.0   \n",
       "100001                   0.0                   0.0                   0.0   \n",
       "100002                   1.0                   0.0                   1.0   \n",
       "100003                   1.0                   0.0                   0.0   \n",
       "100004                   0.0                   0.0                   0.0   \n",
       "\n",
       "        trade_type_last3_3.0  trade_type_last3_4.0  trade_type_last3_nan  \n",
       "80000                    0.0                   0.0                   0.0  \n",
       "80001                    0.0                   1.0                   0.0  \n",
       "80002                    0.0                   0.0                   0.0  \n",
       "80003                    0.0                   1.0                   0.0  \n",
       "80004                    0.0                   1.0                   0.0  \n",
       "...                      ...                   ...                   ...  \n",
       "100000                   0.0                   1.0                   0.0  \n",
       "100001                   0.0                   1.0                   0.0  \n",
       "100002                   0.0                   0.0                   0.0  \n",
       "100003                   0.0                   1.0                   0.0  \n",
       "100004                   0.0                   1.0                   0.0  \n",
       "\n",
       "[20005 rows x 38 columns]"
      ]
     },
     "execution_count": 46,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from sklearn.preprocessing import OneHotEncoder\n",
    "encoder = OneHotEncoder(sparse=False, handle_unknown='ignore').fit(train_data[categorical_cols])\n",
    "encoded_cols = list(encoder.get_feature_names(categorical_cols))\n",
    "X_train[encoded_cols] = encoder.transform(X_train[categorical_cols])\n",
    "X_test[encoded_cols] = encoder.transform(X_test[categorical_cols])\n",
    "X_test"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "id": "c77183f9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>current_coupon</th>\n",
       "      <th>time_to_maturity</th>\n",
       "      <th>reporting_delay</th>\n",
       "      <th>trade_size</th>\n",
       "      <th>curve_based_price</th>\n",
       "      <th>received_time_diff_last1</th>\n",
       "      <th>trade_price_last1</th>\n",
       "      <th>trade_size_last1</th>\n",
       "      <th>curve_based_price_last1</th>\n",
       "      <th>received_time_diff_last2</th>\n",
       "      <th>...</th>\n",
       "      <th>trade_type_last1_3</th>\n",
       "      <th>trade_type_last1_4</th>\n",
       "      <th>trade_type_last2_2.0</th>\n",
       "      <th>trade_type_last2_3.0</th>\n",
       "      <th>trade_type_last2_4.0</th>\n",
       "      <th>trade_type_last2_nan</th>\n",
       "      <th>trade_type_last3_2.0</th>\n",
       "      <th>trade_type_last3_3.0</th>\n",
       "      <th>trade_type_last3_4.0</th>\n",
       "      <th>trade_type_last3_nan</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>80000</th>\n",
       "      <td>0.391489</td>\n",
       "      <td>0.015186</td>\n",
       "      <td>5.180258e-07</td>\n",
       "      <td>0.004801</td>\n",
       "      <td>0.651455</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.651969</td>\n",
       "      <td>0.004801</td>\n",
       "      <td>0.651455</td>\n",
       "      <td>4.159929e-02</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>80001</th>\n",
       "      <td>0.391489</td>\n",
       "      <td>0.015155</td>\n",
       "      <td>5.327536e-07</td>\n",
       "      <td>0.005801</td>\n",
       "      <td>0.649765</td>\n",
       "      <td>9.869512e-03</td>\n",
       "      <td>0.656217</td>\n",
       "      <td>0.004801</td>\n",
       "      <td>0.651455</td>\n",
       "      <td>9.867779e-03</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>80002</th>\n",
       "      <td>0.391489</td>\n",
       "      <td>0.015155</td>\n",
       "      <td>5.938975e-07</td>\n",
       "      <td>0.005801</td>\n",
       "      <td>0.649765</td>\n",
       "      <td>7.164020e-07</td>\n",
       "      <td>0.662657</td>\n",
       "      <td>0.005801</td>\n",
       "      <td>0.649765</td>\n",
       "      <td>9.868495e-03</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>80003</th>\n",
       "      <td>0.391489</td>\n",
       "      <td>0.015155</td>\n",
       "      <td>5.938975e-07</td>\n",
       "      <td>0.005801</td>\n",
       "      <td>0.649765</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.662657</td>\n",
       "      <td>0.005801</td>\n",
       "      <td>0.649765</td>\n",
       "      <td>7.162762e-07</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>80004</th>\n",
       "      <td>0.391489</td>\n",
       "      <td>0.015056</td>\n",
       "      <td>1.014866e-06</td>\n",
       "      <td>0.002801</td>\n",
       "      <td>0.651591</td>\n",
       "      <td>3.112910e-02</td>\n",
       "      <td>0.663506</td>\n",
       "      <td>0.005801</td>\n",
       "      <td>0.649765</td>\n",
       "      <td>3.112363e-02</td>\n",
       "      <td>...</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100000</th>\n",
       "      <td>0.404255</td>\n",
       "      <td>0.041867</td>\n",
       "      <td>5.875098e-07</td>\n",
       "      <td>0.003601</td>\n",
       "      <td>0.626364</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.611616</td>\n",
       "      <td>0.003601</td>\n",
       "      <td>0.626364</td>\n",
       "      <td>7.180752e-02</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100001</th>\n",
       "      <td>0.404255</td>\n",
       "      <td>0.041707</td>\n",
       "      <td>3.153850e-06</td>\n",
       "      <td>0.003601</td>\n",
       "      <td>0.633194</td>\n",
       "      <td>5.044521e-02</td>\n",
       "      <td>0.612957</td>\n",
       "      <td>0.003601</td>\n",
       "      <td>0.626364</td>\n",
       "      <td>5.043635e-02</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100002</th>\n",
       "      <td>0.404255</td>\n",
       "      <td>0.041704</td>\n",
       "      <td>5.436067e-07</td>\n",
       "      <td>0.003601</td>\n",
       "      <td>0.634073</td>\n",
       "      <td>9.474416e-04</td>\n",
       "      <td>0.631325</td>\n",
       "      <td>0.003601</td>\n",
       "      <td>0.633194</td>\n",
       "      <td>5.138362e-02</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100003</th>\n",
       "      <td>0.404255</td>\n",
       "      <td>0.041634</td>\n",
       "      <td>5.173851e-07</td>\n",
       "      <td>0.001800</td>\n",
       "      <td>0.639204</td>\n",
       "      <td>2.220452e-02</td>\n",
       "      <td>0.639294</td>\n",
       "      <td>0.003601</td>\n",
       "      <td>0.634073</td>\n",
       "      <td>2.314790e-02</td>\n",
       "      <td>...</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100004</th>\n",
       "      <td>0.404255</td>\n",
       "      <td>0.041634</td>\n",
       "      <td>6.525884e-07</td>\n",
       "      <td>0.001800</td>\n",
       "      <td>0.639204</td>\n",
       "      <td>1.552204e-06</td>\n",
       "      <td>0.662827</td>\n",
       "      <td>0.001800</td>\n",
       "      <td>0.639204</td>\n",
       "      <td>2.220217e-02</td>\n",
       "      <td>...</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>20005 rows × 33 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        current_coupon  time_to_maturity  reporting_delay  trade_size  \\\n",
       "80000         0.391489          0.015186     5.180258e-07    0.004801   \n",
       "80001         0.391489          0.015155     5.327536e-07    0.005801   \n",
       "80002         0.391489          0.015155     5.938975e-07    0.005801   \n",
       "80003         0.391489          0.015155     5.938975e-07    0.005801   \n",
       "80004         0.391489          0.015056     1.014866e-06    0.002801   \n",
       "...                ...               ...              ...         ...   \n",
       "100000        0.404255          0.041867     5.875098e-07    0.003601   \n",
       "100001        0.404255          0.041707     3.153850e-06    0.003601   \n",
       "100002        0.404255          0.041704     5.436067e-07    0.003601   \n",
       "100003        0.404255          0.041634     5.173851e-07    0.001800   \n",
       "100004        0.404255          0.041634     6.525884e-07    0.001800   \n",
       "\n",
       "        curve_based_price  received_time_diff_last1  trade_price_last1  \\\n",
       "80000            0.651455              0.000000e+00           0.651969   \n",
       "80001            0.649765              9.869512e-03           0.656217   \n",
       "80002            0.649765              7.164020e-07           0.662657   \n",
       "80003            0.649765              0.000000e+00           0.662657   \n",
       "80004            0.651591              3.112910e-02           0.663506   \n",
       "...                   ...                       ...                ...   \n",
       "100000           0.626364              0.000000e+00           0.611616   \n",
       "100001           0.633194              5.044521e-02           0.612957   \n",
       "100002           0.634073              9.474416e-04           0.631325   \n",
       "100003           0.639204              2.220452e-02           0.639294   \n",
       "100004           0.639204              1.552204e-06           0.662827   \n",
       "\n",
       "        trade_size_last1  curve_based_price_last1  received_time_diff_last2  \\\n",
       "80000           0.004801                 0.651455              4.159929e-02   \n",
       "80001           0.004801                 0.651455              9.867779e-03   \n",
       "80002           0.005801                 0.649765              9.868495e-03   \n",
       "80003           0.005801                 0.649765              7.162762e-07   \n",
       "80004           0.005801                 0.649765              3.112363e-02   \n",
       "...                  ...                      ...                       ...   \n",
       "100000          0.003601                 0.626364              7.180752e-02   \n",
       "100001          0.003601                 0.626364              5.043635e-02   \n",
       "100002          0.003601                 0.633194              5.138362e-02   \n",
       "100003          0.003601                 0.634073              2.314790e-02   \n",
       "100004          0.001800                 0.639204              2.220217e-02   \n",
       "\n",
       "        ...  trade_type_last1_3  trade_type_last1_4  trade_type_last2_2.0  \\\n",
       "80000   ...                 0.0                 0.0                   0.0   \n",
       "80001   ...                 0.0                 1.0                   1.0   \n",
       "80002   ...                 0.0                 1.0                   0.0   \n",
       "80003   ...                 0.0                 1.0                   0.0   \n",
       "80004   ...                 1.0                 0.0                   0.0   \n",
       "...     ...                 ...                 ...                   ...   \n",
       "100000  ...                 0.0                 0.0                   0.0   \n",
       "100001  ...                 0.0                 1.0                   1.0   \n",
       "100002  ...                 0.0                 1.0                   0.0   \n",
       "100003  ...                 1.0                 0.0                   0.0   \n",
       "100004  ...                 1.0                 0.0                   0.0   \n",
       "\n",
       "        trade_type_last2_3.0  trade_type_last2_4.0  trade_type_last2_nan  \\\n",
       "80000                    0.0                   1.0                   0.0   \n",
       "80001                    0.0                   0.0                   0.0   \n",
       "80002                    0.0                   1.0                   0.0   \n",
       "80003                    0.0                   1.0                   0.0   \n",
       "80004                    0.0                   1.0                   0.0   \n",
       "...                      ...                   ...                   ...   \n",
       "100000                   0.0                   1.0                   0.0   \n",
       "100001                   0.0                   0.0                   0.0   \n",
       "100002                   0.0                   1.0                   0.0   \n",
       "100003                   0.0                   1.0                   0.0   \n",
       "100004                   1.0                   0.0                   0.0   \n",
       "\n",
       "        trade_type_last3_2.0  trade_type_last3_3.0  trade_type_last3_4.0  \\\n",
       "80000                    1.0                   0.0                   0.0   \n",
       "80001                    0.0                   0.0                   1.0   \n",
       "80002                    1.0                   0.0                   0.0   \n",
       "80003                    0.0                   0.0                   1.0   \n",
       "80004                    0.0                   0.0                   1.0   \n",
       "...                      ...                   ...                   ...   \n",
       "100000                   0.0                   0.0                   1.0   \n",
       "100001                   0.0                   0.0                   1.0   \n",
       "100002                   1.0                   0.0                   0.0   \n",
       "100003                   0.0                   0.0                   1.0   \n",
       "100004                   0.0                   0.0                   1.0   \n",
       "\n",
       "        trade_type_last3_nan  \n",
       "80000                    0.0  \n",
       "80001                    0.0  \n",
       "80002                    0.0  \n",
       "80003                    0.0  \n",
       "80004                    0.0  \n",
       "...                      ...  \n",
       "100000                   0.0  \n",
       "100001                   0.0  \n",
       "100002                   0.0  \n",
       "100003                   0.0  \n",
       "100004                   0.0  \n",
       "\n",
       "[20005 rows x 33 columns]"
      ]
     },
     "execution_count": 47,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X_train = X_train[numeric_cols + encoded_cols]\n",
    "X_test = X_test[numeric_cols + encoded_cols]\n",
    "X_test"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f6a01aa9",
   "metadata": {},
   "source": [
    "# 1st Model: Train A Ridge Regression Model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "id": "da0f2530",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Ridge()"
      ]
     },
     "execution_count": 48,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from sklearn.linear_model import Ridge\n",
    "model = Ridge()\n",
    "model.fit(X_train, y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "id": "d714e5d3",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The RMSE loss is 0.8347713466362221.\n"
     ]
    }
   ],
   "source": [
    "from sklearn.metrics import mean_squared_error\n",
    "train_preds = model.predict(X_test)\n",
    "train_preds\n",
    "\n",
    "rmse = np.sqrt(mean_squared_error(y_test,train_preds))\n",
    "print('The RMSE loss is {}.'.format(rmse))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "id": "c7e2af16",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([104.29597846, 104.3341197 , 104.62045772, ..., 101.82109227,\n",
       "       102.37259306, 103.25961447])"
      ]
     },
     "execution_count": 50,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "test_preds = model.predict(X_test)\n",
    "test_preds"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cf144ade",
   "metadata": {},
   "source": [
    "# Using Random Forest Regression"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "id": "f5c68c53",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.ensemble import RandomForestRegressor"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "id": "3cf80042",
   "metadata": {},
   "outputs": [],
   "source": [
    "rf1 = RandomForestRegressor(n_jobs=-1, random_state=42)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "id": "fb455749",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "RandomForestRegressor(n_jobs=-1, random_state=42)"
      ]
     },
     "execution_count": 54,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "rf1.fit(X_train, y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "id": "3867280d",
   "metadata": {},
   "outputs": [],
   "source": [
    "rf1_train_preds = rf1.predict(X_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "id": "e14d5482",
   "metadata": {},
   "outputs": [],
   "source": [
    "rf1_train_rmse = np.sqrt(mean_squared_error(y_train, rf1_train_preds))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "id": "0550f4f2",
   "metadata": {},
   "outputs": [],
   "source": [
    "rf1_val_preds = rf1.predict(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 58,
   "id": "a6ce16a6",
   "metadata": {},
   "outputs": [],
   "source": [
    "rf1_val_rmse = np.sqrt(mean_squared_error(test[target_col], rf1_val_preds))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "id": "2547f182",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train RMSE: $ 0.3017586122984349, Validation RMSE: $ 0.786742296895183\n"
     ]
    }
   ],
   "source": [
    "print('Train RMSE: $ {}, Validation RMSE: $ {}'.format(rf1_train_rmse, rf1_val_rmse))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 60,
   "id": "591aa102",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([104.121891  , 104.12976648, 104.509755  , ..., 103.751214  ,\n",
       "       103.61130326, 103.8128957 ])"
      ]
     },
     "execution_count": 60,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "rf1_test_preds = rf1.predict(X_test)\n",
    "rf1_test_preds"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "135f27bc",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.8"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
